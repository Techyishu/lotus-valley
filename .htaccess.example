# Enable Rewrite Engine
RewriteEngine On

# Prevent directory browsing
Options -Indexes

# Security Headers
<IfModule mod_headers.c>
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    # Prevent caching during development
    Header set Cache-Control "no-cache, no-store, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "0"
</IfModule>

# Protect sensitive files
<FilesMatch "\.(htaccess|htpasswd|ini|log|sql)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Protect includes directory
<IfModule mod_rewrite.c>
    RewriteRule ^includes/(.*)$ - [F,L]
</IfModule>

# Protect database.sql
<Files "database.sql">
    Order Allow,Deny
    Deny from all
</Files>

# Protect install.lock
<Files "install.lock">
    Order Allow,Deny
    Deny from all
</Files>

# PHP Settings
<IfModule mod_php7.c>
    php_value upload_max_filesize 10M
    php_value post_max_size 10M
    php_value max_execution_time 300
    php_value max_input_time 300
</IfModule>

# Prevent access to version control
<IfModule mod_rewrite.c>
    RewriteRule ^\.git - [F,L]
</IfModule>

# Database Environment Variables
# Hostinger shared hosting supports SetEnv in .htaccess
# Copy this file to .htaccess and replace with your actual database credentials
<IfModule mod_env.c>
    SetEnv DB_HOST "localhost"
    SetEnv DB_NAME "your_database_name"
    SetEnv DB_USER "your_database_username"
    SetEnv DB_PASS "your_database_password"
    SetEnv DB_PORT "3306"
    SetEnv DB_TYPE "mysql"
</IfModule>

# Protect config.php from direct access
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

# Protect includes/config.php from direct access
<FilesMatch "^includes/config\.php$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

